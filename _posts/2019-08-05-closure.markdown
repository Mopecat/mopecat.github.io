---
layout:     post
title:      "JavaScript åŸºç¡€å¼ºåŒ–ï¼šé—­åŒ…"
subtitle:   "åŸºç¡€æˆå°±é«˜åº¦"
date:       2019-08-05 12:00:00
author:     "Mopecat"
header-img: "img/post-bg-js-version.jpg"
catalog: true
tags:
    - Javascript åŸºç¡€å¼ºåŒ–
    - Javascript
    - ES6
    - Chrome
---

é—­åŒ…çš„æ¦‚å¿µå¯ä»¥è¯´æ˜¯jsé‡Œè€ç”Ÿå¸¸è°ˆçš„äº†ï¼Œå®ƒå¯ä»¥è¯´æ˜¯javascriptæœ€åŸºæœ¬æœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºå®ƒæ¶‰åŠåˆ°å¾ˆå¤šjsçš„åŸºæœ¬æ¦‚å¿µã€‚æ¯”å¦‚ï¼š***ä½œç”¨åŸŸï¼Œä½œç”¨åŸŸé“¾ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œè°ƒç”¨æ ˆï¼Œå†…å­˜ç®¡ç†ç­‰æ¦‚å¿µ*** 
ä¸ºäº†æ›´å¥½çš„ç†è§£é—­åŒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»åŸºç¡€èµ°èµ·ï¼Œç®€å•äº†è§£è¿™äº›æ¦‚å¿µï¼š
### ä½œç”¨åŸŸ
ä»»ä½•è¯­è¨€éƒ½æœ‰ä½œç”¨åŸŸè¿™ä¸ªæ¦‚å¿µï¼Œä½œç”¨åŸŸæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¯´ç™½äº†ä¹Ÿå°±æ˜¯**å¯»æ‰¾å˜é‡çš„è§„åˆ™**ï¼Œåœ¨javascriptä¸­ç°åœ¨ä¸ºæ­¢æœ‰ä¸‰ç§ä½œç”¨åŸŸï¼š**å‡½æ•°ä½œç”¨åŸŸ**ï¼Œ**å…¨å±€ä½œç”¨åŸŸ**ï¼Œ**å—çº§ä½œç”¨åŸŸ**
#### å‡½æ•°ä½œç”¨åŸŸå’Œå…¨å±€ä½œç”¨åŸŸ
é€šè¿‡å‡ ä¸ªğŸŒ°æ€»ç»“ä¸€ä¸‹
```javascript
function a(){
    var aa = 'å‡½æ•°ä½œç”¨åŸŸ';
    console.log(aa)
}
a()
```
å˜é‡`aa`åœ¨å‡½æ•° `a`çš„ä½œç”¨åŸŸå†…ï¼Œæ‰€ä»¥æ‰§è¡Œ`a()`å¯ä»¥æ­£å¸¸è¾“å‡º `å‡½æ•°ä½œç”¨åŸŸ`
```javascript
var bb = 'å…¨å±€ä½œç”¨åŸŸ'
function b(){
    console.log(bb)
}
b()
```
æ‰§è¡Œå‡½æ•°`b`ï¼Œåœ¨å‡½æ•°`b`è‡ªèº«ä½œç”¨åŸŸä¸­æ²¡æœ‰å˜é‡`bb`ï¼Œæ‰€ä»¥å‘å¤–æ‰©å¤§ä½œç”¨åŸŸå¯»æ‰¾ï¼Œåœ¨å¤–å±‚çš„å…¨å±€ä½œç”¨åŸŸä¸­æ‰¾åˆ°äº†å˜é‡`bb`å› æ­¤æˆåŠŸè¾“å‡º`å…¨å±€ä½œç”¨åŸŸ`
```javascript
function a(){
    var a = 'å‡½æ•°ä¸€'
}
function b(){
    console.log(a)
}
b()
```
æ‰§è¡Œä¸Šè¿°ä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ¯ä¸€ä¸ªå‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼Œåœ¨å‡½æ•°`b`ä¸­æ²¡æœ‰æ‰¾åˆ°å˜é‡`a`åŒæ ·åœ¨å¤–å±‚çš„å…¨å±€ä½œç”¨åŸŸä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°ï¼Œæ‰€ä»¥æ‰§è¡Œ`b`å‡½æ•°æŠ¥é”™
```javascript
var b = 'å…¨å±€'
function func1() {
    var b = 'ä¸€å±‚'
    function func2() {
        console.log(b)
    }
    func2()
}

func1()
```
æ‰§è¡Œä¸Šè¿°ä»£ç ï¼Œå¯¹æ¯”ç¬¬äºŒä¸ªä¾‹å­å¯ä»¥çŸ¥é“å‡½æ•°ä½œç”¨åŸŸçš„èŒƒå›´æ˜¯é€çº§å‘å¤–é€’å¢çš„
é€šè¿‡ä»¥ä¸Šå‡ æ¡æ¡ä¾‹å­å¯ä»¥ç®€å•æ€»ç»“å‡ æ¡è§„åˆ™ï¼š
* æ¯ä¸ªå‡½æ•°ä½œç”¨åŸŸéƒ½æ˜¯ç‹¬ç«‹çš„
* å˜é‡ä½œç”¨åŸŸçš„æŸ¥æ‰¾æ˜¯ä¸€ä¸ªæ‰©æ•£è¿‡ç¨‹ï¼Œä¸€çº§ä¸€çº§å‘å¤–å°±è¿‘å¯»æ‰¾ã€‚
* æœ€å¤–å±‚å°±æ˜¯å…¨å±€ä½œç”¨åŸŸ

ç”±æ­¤æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä½œç”¨åŸŸçš„å·¥ä½œæ–¹å¼å°±åƒç¯ç¯ç›¸æ‰£çš„è”è°ƒï¼Œé€çº§é€’è¿›è¿™ä¹Ÿå°±æ˜¯ä½œç”¨åŸŸé“¾è¯´æ³•çš„ç”±æ¥
#### å—çº§ä½œç”¨åŸŸ
å—çº§ä½œç”¨åŸŸæ˜¯`ES6`åæ‰å‡ºç°çš„ç”±`let` å’Œ `const` å£°æ˜çš„å˜é‡ï¼Œä¸æ¶‰åŠåˆ°å˜é‡æå‡ï¼Œä½œç”¨åœ¨å—çº§ä½œç”¨åŸŸä¸­ï¼Œä¹Ÿå°±æ˜¯ä»£ç å—ä¸­ï¼Œå†é€šä¿—ä¸€ç‚¹å°±æ˜¯ä¸¤ä¸ªå¤§æ‹¬å·ä¸­(å½“ç„¶è¿™ç§ä¹¦æ³•å¹¶ä¸å…¨é¢)
ç”±äºå—çº§ä½œç”¨åŸŸçš„å˜é‡ä¸æ¶‰åŠå˜é‡æå‡æ‰€ä»¥å‡ºç°äº†ä¸€ä¸ªæ–°é²œçš„æ¦‚å¿µï¼Œæ¯”å¦‚ **æš‚å­˜æ­»åŒº**
ç”±`let`å’Œ`const`å£°æ˜çš„å˜é‡ä¸å­˜åœ¨å˜é‡æå‡ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ç§æƒ…å†µ
```javascript
function a(){
    console.log(aa)
    let aa = 111
}
```
ä¼šæŠ¥é”™ï¼Œä»¥ä¸Šåœ¨è¿™ä¸ªå—çº§ä½œç”¨åŸŸå†…`let aa`ä¹‹å‰çš„åŒºåŸŸè¢«ç§°ä¸º **æš‚å­˜æ­»åŒº**
è¿˜è¦ä¸€ç§æƒ…å†µå°±æ˜¯å‡½æ•°å‚æ•°ä¹Ÿä¼šæœ‰æš‚å­˜æ­»åŒºçš„é—®é¢˜ï¼Œä¸è¿‡è¿™ç§æƒ…å†µæ¯”è¾ƒå°‘è§
```javascript
function a(arg1 = arg2, arg2){
    console.log(arg1,arg2)
}
a(undefined,'arg2')
```
ä¼šæŠ¥é”™ï¼ŒåŒæ ·çš„æš‚å­˜æ­»åŒºé—®é¢˜ï¼Œå„ä½è€é“ä»¥åè¦æ³¨æ„ä¸€ä¸‹å“ˆ

### æ‰§è¡Œä¸Šä¸‹æ–‡
Javascriptæ‰§è¡Œä¸»è¦åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š**ä»£ç é¢„ç¼–è¯‘é˜¶æ®µ**ï¼Œ**ä»£ç æ‰§è¡Œé˜¶æ®µ**
é¢„ç¼–è¯‘é˜¶æ®µæ˜¯å‰ç½®é˜¶æ®µï¼Œè¿™ä¸ªæ—¶å€™ç”±ç¼–è¯‘å™¨å°† JavaScript ä»£ç ç¼–è¯‘æˆå¯æ‰§è¡Œçš„ä»£ç ï¼Œæ‰§è¡Œé˜¶æ®µä¸»è¦ä»»åŠ¡æ˜¯æ‰§è¡Œä»£ç ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡åœ¨è¿™ä¸ªé˜¶æ®µå…¨éƒ¨åˆ›å»ºå®Œæˆã€‚
åœ¨é€šè¿‡è¯­æ³•åˆ†æï¼Œç¡®è®¤è¯­æ³•æ— è¯¯ä¹‹åï¼ŒJavaScript ä»£ç åœ¨é¢„ç¼–è¯‘é˜¶æ®µå¯¹å˜é‡çš„å†…å­˜ç©ºé—´è¿›è¡Œåˆ†é…ã€‚é¢„ç¼–è¯‘é˜¶æ®µæˆ‘ä»¬éœ€è¦æ³¨æ„çš„ä¸‰ç‚¹ï¼š
* é¢„ç¼–è¯‘é˜¶æ®µè¿›è¡Œå˜é‡å£°æ˜ï¼›
* é¢„ç¼–è¯‘é˜¶æ®µå˜é‡å£°æ˜è¿›è¡Œæå‡ï¼Œä½†æ˜¯å€¼ä¸º undefinedï¼›
* é¢„ç¼–è¯‘é˜¶æ®µæ‰€æœ‰éè¡¨è¾¾å¼çš„å‡½æ•°å£°æ˜è¿›è¡Œæå‡ã€‚

æ€»ç»“ï¼š***ä½œç”¨åŸŸåœ¨é¢„ç¼–è¯‘é˜¶æ®µç¡®å®šï¼Œä½†æ˜¯ä½œç”¨åŸŸé“¾æ˜¯åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡çš„åˆ›å»ºé˜¶æ®µå®Œå…¨ç”Ÿæˆçš„ã€‚å› ä¸ºå‡½æ•°åœ¨è°ƒç”¨æ—¶ï¼Œæ‰ä¼šå¼€å§‹åˆ›å»ºå¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚æ‰§è¡Œä¸Šä¸‹æ–‡åŒ…æ‹¬äº†ï¼šå˜é‡å¯¹è±¡ã€ä½œç”¨åŸŸé“¾ä»¥åŠ this çš„æŒ‡å‘***
### è°ƒç”¨æ ˆ
æ€»çš„æ¥è¯´å°±åƒæ˜¯è¿›ä¸€ä¸ªåªæœ‰ä¸€ä¸ªé—¨çš„å¤§å·´è½¦ï¼ˆè°ƒç”¨æ ˆï¼‰ï¼Œå…ˆä¸Šè½¦çš„åæœ€åé¢ï¼Œä¾æ¬¡æ¥åï¼Œé‚£ä¸‹è½¦çš„æ—¶å€™ï¼ˆè°ƒç”¨ç»“æŸåï¼‰æœ€å…ˆä¸Šè½¦çš„ä¸€ä¸ªå°±è¦æœ€åä¸€ä¸ªä¸‹è½¦ã€‚
çœ‹ç å¥½äº†ï¼š
```javascript
function f1() {
  f2()
}
function f2() {
  f3()
}
function f3() {
  f4()
}
function f4() {
  console.log('f4')
}
f1()
```
è¿™æ ·å½¢æˆçš„è°ƒç”¨æ ˆï¼Œæœ€å…ˆå…¥æ ˆçš„æ˜¯å°±æ˜¯æœ€å…ˆè°ƒç”¨çš„`f1`ç„¶å`f2,f3,f4`ç›¸å½“äºä¸€ä¸ªä¾æ¬¡ä¸Šè½¦çš„äººï¼Œé‚£è°ƒç”¨ç»“æŸåä¹Ÿå°±æ˜¯ä¸‹è½¦äº†ï¼Œæ’é˜Ÿä¸‹è½¦ï¼Œæœ€åä¸Šçš„æ’åœ¨æœ€å‰é¢æ‰€ä»¥æœ€å…ˆä¸‹è½¦ã€‚æ‰€ä»¥`f4`æœ€å…ˆå‡ºæ ˆï¼Œç„¶åæ˜¯`f3,f2,f1`æŒ‰é¡ºåºä¸€ä¸ªä¸€ä¸ªå‡ºæ ˆ

æ³¨æ„ï¼š
***æ­£å¸¸æ¥è®²ï¼Œåœ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•å¹¶å‡ºæ ˆæ—¶ï¼Œå‡½æ•°å†…å±€éƒ¨å˜é‡åœ¨ä¸‹ä¸€ä¸ªåƒåœ¾å›æ”¶èŠ‚ç‚¹ä¼šè¢«å›æ”¶ï¼Œè¯¥å‡½æ•°å¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡å°†ä¼šè¢«é”€æ¯ï¼Œè¿™ä¹Ÿæ­£æ˜¯æˆ‘ä»¬åœ¨å¤–ç•Œæ— æ³•è®¿é—®å‡½æ•°å†…å®šä¹‰çš„å˜é‡çš„åŸå› ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰åœ¨å‡½æ•°æ‰§è¡Œæ—¶ï¼Œç›¸å…³å‡½æ•°å¯ä»¥è®¿é—®è¯¥å˜é‡ï¼Œè¯¥å˜é‡åœ¨é¢„ç¼–è¯‘é˜¶æ®µè¿›è¡Œåˆ›å»ºï¼Œåœ¨æ‰§è¡Œé˜¶æ®µè¿›è¡Œæ¿€æ´»ï¼Œåœ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œç›¸å…³ä¸Šä¸‹æ–‡è¢«é”€æ¯ã€‚***

æ¥ä¸‹æ¥å°±è¦è¿›å…¥æ­£é¢˜äº†ï¼š**é—­åŒ…**
### å†…å­˜ç®¡ç†
å†…å­˜ç®¡ç†æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­çš„æ¦‚å¿µã€‚ä¸è®ºæ˜¯ä»€ä¹ˆç¨‹åºè¯­è¨€ï¼Œå†…å­˜ç®¡ç†éƒ½æ˜¯æŒ‡å¯¹å†…å­˜ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ã€‚
å†…å­˜çš„ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬ä»¥ä¸‹å‡ ç‚¹ï¼š 
* åˆ†é…å†…å­˜ç©ºé—´
* è¯»å†™å†…å­˜
* é‡Šæ”¾å†…å­˜ç©ºé—´

ğŸŒ°ï¼š
```javascript
let a = 'åˆ†é…å­˜å‚¨ç©ºé—´'
console.log(a) // ä½¿ç”¨å†…å­˜ç©ºé—´
a = null // é‡Šæ”¾å†…å­˜ç©ºé—´
```
å†…å­˜ç©ºé—´åˆ†ä¸º **å †å†…å­˜** å’Œ **æ ˆå†…å­˜**
* æ ˆå†…å­˜ï¼šç”±æ“ä½œç³»ç»Ÿè‡ªåŠ¨åˆ†é…é‡Šæ”¾ï¼Œå­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼ï¼Œå±€éƒ¨å˜é‡çš„å€¼ç­‰ã€‚
* å †å†…å­˜ï¼š ä¸€èˆ¬ç”±å¼€å‘è€…åˆ†é…é‡Šæ”¾ï¼Œè¿™éƒ¨åˆ†ç©ºé—´å°±è¦è€ƒè™‘åƒåœ¾å›æ”¶çš„é—®é¢˜ã€‚

>***åˆ’é‡ç‚¹ `javascript`ä¸­åŸºæœ¬æ•°æ®ç±»å‹å­˜å‚¨åœ¨æ ˆå†…å­˜ä¸­ï¼Œå¼•ç”¨ç±»å‹å­˜å‚¨åœ¨å †å†…å­˜ä¸­ã€‚å¼•ç”¨ç±»å‹ä¸€èˆ¬æ˜¯å­˜å‚¨åœ¨æ ˆå†…å­˜çš„ä¸€ä¸ªå†…å­˜åœ°å€æŒ‡å‘å †å†…å­˜ä¸­çš„ä½ç½®***
ä¸»é¢˜æ˜¯è¯´é—­åŒ…ä¸ºä»€ä¹ˆè¿™é‡Œæåˆ°äº†å†…å­˜ç©ºé—´å‘¢ï¼Œå‰é¢äº†è§£äº†ä¸€ä¸‹å†…å­˜ç®¡ç†ç›¸å…³çš„åŸºæœ¬çŸ¥è¯†ï¼Œæ¥ä¸‹æ¥è¯´åé¢é—­åŒ…ä¼šæ¶‰åŠåˆ°çš„**å†…å­˜æ³„æ¼**
> å†…å­˜æ³„æ¼æ˜¯æŒ‡å†…å­˜ç©ºé—´æ˜æ˜å·²ç»ä¸å†è¢«ä½¿ç”¨ï¼Œä½†ç”±äºæŸç§åŸå› å¹¶æ²¡æœ‰è¢«é‡Šæ”¾çš„ç°è±¡ã€‚

è¿™æ˜¯ä¸€ä¸ªéå¸¸â€œç„å­¦â€çš„æ¦‚å¿µï¼Œå› ä¸ºå†…å­˜ç©ºé—´æ˜¯å¦è¿˜åœ¨ä½¿ç”¨ï¼ŒæŸç§ç¨‹åº¦ä¸Šæ˜¯ä¸å¯åˆ¤å®šé—®é¢˜ï¼Œæˆ–è€…åˆ¤å®šæˆæœ¬å¾ˆé«˜ã€‚å†…å­˜æ³„æ¼å±å®³å´éå¸¸ç›´è§‚ï¼šå®ƒä¼šç›´æ¥å¯¼è‡´ç¨‹åºè¿è¡Œç¼“æ…¢ï¼Œç”šè‡³å´©æºƒã€‚è¿™ä¸ªæ—¶å€™å°±å¾—å¼€å§‹ä¸¾ä¸ªğŸŒ°äº†ï¼š
```javascript
let el = document.getElementById("el")
el.class = 'el-class'
// ç§»é™¤ element èŠ‚ç‚¹
function remove() {
    element.parentNode.removeChild(element)
}
```
ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬åªæ˜¯æŠŠ `id` ä¸º `el` çš„èŠ‚ç‚¹ç§»é™¤ï¼Œä½†æ˜¯å˜é‡ `el` ä¾ç„¶å­˜åœ¨ï¼Œè¯¥èŠ‚ç‚¹å æœ‰çš„å†…å­˜æ— æ³•è¢«é‡Šæ”¾ã€‚
![](/img/in-post/post-closure/neicunxielou.jpg)
æˆ‘ä»¬éœ€è¦åœ¨ `remove` æ–¹æ³•ä¸­æ·»åŠ ï¼š`el = null`ï¼Œè¿™æ ·æ›´ä¸ºç¨³å¦¥

ğŸŒ°2ï¼š
```javascript
var el = document.getElementById('el')
el.innerHTML = '<button id="button">ç‚¹æˆ‘å‘€</button>'

var button = document.getElementById('button')
button.addEventListener('click', function() {
    // ...
})

el.innerHTML = ''
```
è¿™æ®µä»£ç æ‰§è¡Œåï¼Œå› ä¸º `element.innerHTML = ''`ï¼Œ`button` å…ƒç´ å·²ç»ä» DOM ä¸­ç§»é™¤äº†ï¼Œä½†æ˜¯ç”±äºå…¶äº‹ä»¶å¤„ç†å¥æŸ„è¿˜åœ¨ï¼Œæ‰€ä»¥ä¾ç„¶æ— æ³•è¢«åƒåœ¾å›æ”¶ã€‚æˆ‘ä»¬è¿˜éœ€è¦å¢åŠ  `removeEventListener`ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚

ğŸŒ°3ï¼š
```javascript
function func1() {
  var name  = 'Mopecat'
  window.setInterval(function() {
    console.log(name)
  }, 1000)
}

func1()
```
è¿™æ®µä»£ç ç”±äº `window.setInterval` çš„å­˜åœ¨ï¼Œå¯¼è‡´ `name` å†…å­˜ç©ºé—´å§‹ç»ˆæ— æ³•è¢«é‡Šæ”¾ï¼Œå¦‚æœä¸æ˜¯ä¸šåŠ¡è¦æ±‚çš„è¯ï¼Œä¸€å®šè¦è®°å¾—åœ¨åˆé€‚çš„æ—¶æœºä½¿ç”¨ `clearInterval` è¿›è¡Œæ¸…ç†ã€‚
### é—­åŒ…
çœ‹è¿‡å„ç§å„æ ·çš„è¯´æ³•ï¼Œæ™¦æ¶©ä¸”å¤šæ ·çš„å®šä¹‰ä»ç„¶ç»™åˆå­¦è€…å¸¦æ¥å›°æƒ‘ï¼Œæ‰€ä»¥ç›´æ¥ä¸€ç‚¹é€šä¿—çš„å®šä¹‰åº”è¯¥æ˜¯ï¼š
> **å‡½æ•°åµŒå¥—å‡½æ•°æ—¶ï¼Œå†…å±‚å‡½æ•°å¼•ç”¨äº†å¤–å±‚å‡½æ•°ä½œç”¨åŸŸä¸‹çš„å˜é‡ï¼Œå¹¶ä¸”å†…å±‚å‡½æ•°åœ¨å…¨å±€ç¯å¢ƒä¸‹å¯è®¿é—®ï¼Œå°±å½¢æˆäº†é—­åŒ…ã€‚**

ç®€å•çš„ä¾‹å­ï¼š

```javascript
function numGenerator() {
    let num = 1
    num++
    return () => {
        console.log(num)
    } 
}

var getNum = numGenerator()
getNum()
```

è¿™ä¸ªç®€å•çš„é—­åŒ…ä¾‹å­ä¸­ï¼Œ`numGenerator` åˆ›å»ºäº†ä¸€ä¸ªå˜é‡ `num`ï¼Œè¿”å›æ‰“å° `num` å€¼çš„åŒ¿åå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¼•ç”¨äº†å˜é‡ `num`ï¼Œä½¿å¾—å¤–éƒ¨å¯ä»¥é€šè¿‡è°ƒç”¨ `getNum` æ–¹æ³•è®¿é—®åˆ°å˜é‡ `num`ï¼Œå› æ­¤åœ¨ `numGenerator` æ‰§è¡Œå®Œæ¯•åï¼Œå³ç›¸å…³è°ƒç”¨æ ˆå‡ºæ ˆåï¼Œå˜é‡ `num` ä¸ä¼šæ¶ˆå¤±ï¼Œä»ç„¶æœ‰æœºä¼šè¢«å¤–ç•Œè®¿é—®ã€‚
å¯¹æ¯”å‰è¿°å†…å®¹ï¼Œæˆ‘ä»¬çŸ¥é“æ­£å¸¸æƒ…å†µä¸‹å¤–ç•Œæ˜¯æ— æ³•è®¿é—®å‡½æ•°å†…éƒ¨å˜é‡çš„ï¼Œå‡½æ•°æ‰§è¡Œå®Œä¹‹åï¼Œä¸Šä¸‹æ–‡å³è¢«é”€æ¯ã€‚ä½†æ˜¯åœ¨ï¼ˆå¤–å±‚ï¼‰å‡½æ•°ä¸­ï¼Œå¦‚æœæˆ‘ä»¬è¿”å›äº†å¦ä¸€ä¸ªå‡½æ•°ï¼Œä¸”è¿™ä¸ªè¿”å›çš„å‡½æ•°ä½¿ç”¨äº†ï¼ˆå¤–å±‚ï¼‰å‡½æ•°å†…çš„å˜é‡ï¼Œå¤–ç•Œå› è€Œä¾¿èƒ½å¤Ÿé€šè¿‡è¿™ä¸ªè¿”å›çš„å‡½æ•°è·å–åŸï¼ˆå¤–å±‚ï¼‰å‡½æ•°å†…éƒ¨çš„å˜é‡å€¼ã€‚è¿™å°±æ˜¯é—­åŒ…çš„åŸºæœ¬åŸç†ã€‚

å› æ­¤ï¼Œç›´è§‚ä¸Šæ¥çœ‹ï¼Œé—­åŒ…è¿™ä¸ªæ¦‚å¿µä¸º `JavaScript` ä¸­è®¿é—®å‡½æ•°å†…å˜é‡æä¾›äº†é€”å¾„å’Œä¾¿åˆ©ã€‚æ‰€ä»¥é—­åŒ…æ˜¯å‰ç«¯è¿›é˜¶å¿…å¤‡åŸºç¡€ã€‚

æ¥ä¸‹æ¥å°±çœ‹ä¸€äº›é¢è¯•é¢˜æ¥åŠ æ·±ç†è§£é—­åŒ…ï¼šï¼ˆéƒ½æ˜¯æ±‚è¾“å‡ºå•¥ï¼‰
```javascript
const foo = (function() {
    var v = 0
    return () => {
        return v++
    }
}())

for (let i = 0; i < 10; i++) {
    foo()
}

console.log(foo())
```
åœ¨å¾ªç¯æ‰§è¡Œæ—¶ï¼Œæ‰§è¡Œ `foo()`ï¼Œè¿™æ ·å¼•ç”¨è‡ªç”±å˜é‡ 10 æ¬¡ï¼Œv è‡ªå¢ 10 æ¬¡ï¼Œæœ€åæ‰§è¡Œ foo æ—¶ï¼Œå¾—åˆ° 10ã€‚ï¼ˆè‡ªç”±å˜é‡æ˜¯æŒ‡æ²¡æœ‰åœ¨ç›¸å…³å‡½æ•°ä½œç”¨åŸŸä¸­å£°æ˜ï¼Œä½†æ˜¯ä½¿ç”¨äº†çš„å˜é‡ã€‚ï¼‰

```javascript
const foo = () => {
    var arr = []
    var i

    for (i = 0; i < 10; i++) {
        arr[i] = function () {
            console.log(i)
        }
    }

    return arr[0]
}

foo()()
```
ç­”æ¡ˆï¼š10ï¼Œè¿™æ—¶è‡ªç”±å˜é‡ä¸º `i`ï¼Œåˆ†æç±»ä¼¼ä¾‹é¢˜ 1ï¼š`foo()` æ‰§è¡Œè¿”å›çš„æ˜¯ `arr[0]`,`arr[0]`æ˜¯ä¸€ä¸ªæ‰“å°`i`çš„`function`è€Œæ­¤æ—¶`i`çš„å€¼æ˜¯10

```javascript
var fn = null
const foo = () => {
    var a = 2
    function innerFoo() { 
        console.log(a)
    }
    fn = innerFoo    
}

const bar = () => {
    fn()
}

foo()
bar()
```
ç­”æ¡ˆï¼š2
æ­£å¸¸æ¥è®²ï¼Œæ ¹æ®è°ƒç”¨æ ˆçš„çŸ¥è¯†ï¼Œ`foo` å‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå…¶æ‰§è¡Œç¯å¢ƒç”Ÿå‘½å‘¨æœŸä¼šç»“æŸï¼Œæ‰€å å†…å­˜è¢«åƒåœ¾æ”¶é›†å™¨é‡Šæ”¾ï¼Œä¸Šä¸‹æ–‡æ¶ˆå¤±ã€‚ä½†æ˜¯é€šè¿‡ `innerFoo` å‡½æ•°èµ‹å€¼ç»™ `fn`ï¼Œ`fn` æ˜¯å…¨å±€å˜é‡ï¼Œè¿™å°±å¯¼è‡´äº† `foo `çš„å˜é‡å¯¹è±¡ `a` ä¹Ÿè¢«ä¿ç•™äº†ä¸‹æ¥ã€‚æ‰€ä»¥å‡½æ•° `fn` åœ¨å‡½æ•° `bar` å†…éƒ¨æ‰§è¡Œæ—¶ï¼Œä¾ç„¶å¯ä»¥è®¿é—®è¿™ä¸ªè¢«ä¿ç•™ä¸‹æ¥çš„å˜é‡å¯¹è±¡ï¼Œè¾“å‡ºç»“æœä¸º 2ã€‚

å°†ä¸Šé¢çš„é¢˜ç¨ä½œä¿®æ”¹
```javascript
var fn = null
const foo = () => {
    var a = 2
    function innerFoo() { 
        console.log(c)            
        console.log(a)
    }
    fn = innerFoo
}

const bar = () => {
    var c = 100
    fn()    
}

foo()
bar()
```
æ‰§è¡Œç»“æœï¼šæŠ¥é”™ã€‚
åœ¨ `bar` ä¸­æ‰§è¡Œ `fn()` æ—¶ï¼Œ`fn()` å·²ç»è¢«å¤åˆ¶ä¸º `innerFoo`ï¼Œå˜é‡ `c` å¹¶ä¸åœ¨å…¶ä½œç”¨åŸŸé“¾ä¸Šï¼Œ`c` åªæ˜¯ `bar` å‡½æ•°çš„å†…éƒ¨å˜é‡ã€‚å› æ­¤æŠ¥é”™ `ReferenceError: c is not definedã€‚`

æ€è€ƒé¢˜ï¼šå¦‚ä½•åˆ©ç”¨é—­åŒ…å®ç°å•ä¾‹æ¨¡å¼?
å•ä¾‹æ¨¡å¼ï¼Œæ˜¯ä¸€ç§å¸¸ç”¨çš„è½¯ä»¶è®¾è®¡æ¨¡å¼ã€‚GoF åœ¨ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹ä¸€ä¹¦ä¸­ç»™å‡ºäº†å¦‚ä¸‹å®šä¹‰ï¼š
> Ensure a class only has one instance, and provide a global point of access to it.

ä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚
ä½¿ç”¨é—­åŒ…æˆ‘ä»¬å¯ä»¥ä¿æŒå¯¹å®ä¾‹çš„å¼•ç”¨ï¼Œä¸è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ï¼Œå› æ­¤ï¼š
```javascript
function Person() {
    this.name = 'lucas'
}

const getSingleInstance = (function(){
     var singleInstance
    return function() {
         if (singleInstance) {
            return singleInstance
         } 
        return singleInstance = new Person()
    }
})()

const instance1 = new getSingleInstance()
const instance2 = new getSingleInstance()
```
äº‹å®ä¸Šï¼Œ`instance1 === instance2`ã€‚å› ä¸ºå€ŸåŠ©é—­åŒ…å˜é‡ `singleInstance`ï¼Œ`instance1` å’Œ `instance2` æ˜¯åŒä¸€å¼•ç”¨çš„ï¼ˆ`singleInstance`ï¼‰ï¼Œè¿™æ­£æ˜¯å•ä¾‹æ¨¡å¼çš„ä½“ç°ã€‚

### ç»“å°¾
é—­åŒ…å°±åˆ†äº«åˆ°è¿™é‡Œäº†ï¼Œåœ¨jsä¸­é—­åŒ…çš„åº”ç”¨éå¸¸ä¹‹å¹¿æ³›ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨åœ¨æ‰å®çš„åŸºç¡€ä¸Šæ›´å¥½çš„åˆ†æå’Œåˆ©ç”¨å®ƒã€‚
æœ¬æ–‡ä¸­éƒ¨åˆ†å†…å®¹æ‘˜è‡ªGitChatä¸Šçš„è¯¾ç¨‹ï¼Œå¦‚æœ‰ä¾µæƒè”ç³»åˆ é™¤ã€‚